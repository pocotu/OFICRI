{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:00:45.232Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:00:45.613Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:07:53.422Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:07:53.796Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:49.549Z"}
{"level":"debug","message":"Executing query [m8mo4l7q0bqwelatr32n]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:49.574Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:49.611Z"}
{"level":"debug","message":"Executing query [m8mo4l8xiimyz65opsi]: SELECT IDArea FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742796649573\"]","timestamp":"2025-03-24T06:10:49.617Z"}
{"level":"debug","message":"Executing query [m8mo4l9186rvmkcmzu]: DELETE FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742796649573\"]","timestamp":"2025-03-24T06:10:49.621Z"}
{"level":"debug","message":"Executing query [m8mo4l93mxco276is59]: INSERT INTO AreaEspecializada (NombreArea, CodigoIdentificacion, TipoArea, Descripcion, IsActive) VALUES (?, ?, ?, ?, ?)","params":"[\"Área de Prueba Automatizada\",\"TEST-AUTO-AREA-1742796649573\",\"ESPECIALIZADA\",\"Área creada para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:10:49.623Z"}
{"level":"debug","message":"Executing query [m8mo4l996w70iw8bmp]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.629Z"}
{"level":"debug","message":"Executing query [m8mo4l9d91sl6q5da]: SELECT * FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742796649573\"]","timestamp":"2025-03-24T06:10:49.633Z"}
{"level":"debug","message":"Executing query [m8mo4l9f4zfsjz2us5n]: UPDATE AreaEspecializada SET NombreArea = ?, Descripcion = ? WHERE IDArea = ?","params":"[\"Área Actualizada\",\"Descripción actualizada para pruebas\",1028]","timestamp":"2025-03-24T06:10:49.635Z"}
{"level":"debug","message":"Executing query [m8mo4l9jea07qq1dvi]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.639Z"}
{"level":"debug","message":"Executing query [m8mo4l9lasc0g2jr1jo]: UPDATE AreaEspecializada SET IsActive = FALSE WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.641Z"}
{"level":"debug","message":"Executing query [m8mo4l9pseayi93gatn]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.645Z"}
{"level":"debug","message":"Executing query [m8mo4l9sq2hz2t8iy3o]: SELECT COUNT(*) as count FROM Usuario WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.648Z"}
{"level":"debug","message":"Executing query [m8mo4l9uqpaxbpbtnwk]: DELETE FROM AreaEspecializada WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.650Z"}
{"level":"debug","message":"Executing query [m8mo4l9yg7vxkswpw4m]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1028]","timestamp":"2025-03-24T06:10:49.654Z"}
{"level":"debug","message":"Executing query [m8mo4l9z2fvx8ozt3mg]: SELECT * FROM AreaEspecializada WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T06:10:49.655Z"}
{"level":"debug","message":"Executing query [m8mo4la1v2fqstsf16s]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:49.658Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:49.660Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:49.867Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:50.724Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T06:10:50.982Z"}
{"level":"info","message":"Iniciando pruebas de autenticación","timestamp":"2025-03-24T06:10:50.988Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:51.057Z"}
{"authTokenExists":true,"level":"info","message":"Estado de tokens después del login:","refreshTokenExists":true,"timestamp":"2025-03-24T06:10:51.071Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:51.123Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:51.257Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:51.396Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:51.414Z"}
{"level":"debug","message":"Executing query [m8mo4mmxbl2qlr5sxw]: SELECT 1 as test","params":"[]","timestamp":"2025-03-24T06:10:51.417Z"}
{"level":"debug","message":"Executing query [m8mo4mmzcayqa1j6wx5]: SELECT * FROM tabla_que_no_existe","params":"[]","timestamp":"2025-03-24T06:10:51.419Z"}
{"code":"ER_NO_SUCH_TABLE","error":"Table 'oficri_sistema.tabla_que_no_existe' doesn't exist","level":"error","message":"Database query error [m8mo4mmzcayqa1j6wx5]","params":"[]","query":"SELECT * FROM tabla_que_no_existe","timestamp":"2025-03-24T06:10:51.421Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:51.422Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:51.544Z"}
{"level":"debug","message":"Executing query [m8mo4mqjnljnxhce8rb]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:51.547Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:51.562Z"}
{"level":"debug","message":"Executing query [m8mo4mr1ki16dcgp5lm]: SELECT IDMesaPartes FROM MesaPartes LIMIT 1","params":"[]","timestamp":"2025-03-24T06:10:51.565Z"}
{"level":"info","message":"No se encontraron Mesas de Partes. Se requiere al menos una Mesa de Partes para las pruebas.","timestamp":"2025-03-24T06:10:51.567Z"}
{"level":"debug","message":"Executing query [m8mo4mr4hqhyyvhmmnn]: SELECT IDArea FROM AreaEspecializada LIMIT 2","params":"[]","timestamp":"2025-03-24T06:10:51.568Z"}
{"level":"debug","message":"Executing query [m8mo4mr5xe93khiu8ad]: SELECT IDUsuario FROM Usuario LIMIT 2","params":"[]","timestamp":"2025-03-24T06:10:51.569Z"}
{"level":"info","message":"No se encontraron suficientes Usuarios. Se requieren al menos dos Usuarios para las pruebas de derivación.","timestamp":"2025-03-24T06:10:51.570Z"}
{"level":"debug","message":"Executing query [m8mo4mr70ssmepak1apd]: SELECT IDDocumento FROM Documento LIMIT 1","params":"[]","timestamp":"2025-03-24T06:10:51.571Z"}
{"level":"warn","message":"No se pueden ejecutar todas las pruebas de Derivación debido a la falta de datos necesarios.","timestamp":"2025-03-24T06:10:51.572Z"}
{"level":"debug","message":"Executing query [m8mo4mrc05z6bi8fsmlh]: SELECT * FROM Derivacion WHERE EstadoDerivacion = ? LIMIT 10","params":"[\"PENDIENTE\"]","timestamp":"2025-03-24T06:10:51.576Z"}
{"level":"debug","message":"Executing query [m8mo4mrgtfhruxesn9n]: SELECT * FROM Derivacion WHERE IDAreaDestino = ? LIMIT 10","params":"[888]","timestamp":"2025-03-24T06:10:51.580Z"}
{"level":"debug","message":"Executing query [m8mo4mri70tcbmv4rq6]: DELETE FROM Documento WHERE IDDocumento = ?","params":"[55]","timestamp":"2025-03-24T06:10:51.582Z"}
{"level":"debug","message":"Executing query [m8mo4mrmjo9ms17o61n]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:51.586Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:53.625Z"}
{"duration":"8ms","level":"info","message":"Request completed","method":"POST","path":"/api/auth/login","status":404,"timestamp":"2025-03-24T06:10:53.696Z"}
{"level":"error","message":"Failed to obtain auth token for document API tests","timestamp":"2025-03-24T06:10:53.700Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:53.707Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T06:10:53.710Z"}
{"level":"info","message":"Usando Mesa de Partes ID: 1, Área ID: 1 y Usuario ID: 1 para las pruebas de Documento","timestamp":"2025-03-24T06:10:53.825Z"}
{"level":"info","message":"Usando Documento ID: 1 para las pruebas de DocumentoArchivo","timestamp":"2025-03-24T06:10:53.943Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:54.085Z"}
{"level":"debug","message":"Executing query [m8mo4op4tb5inxybsh]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:54.088Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:54.100Z"}
{"level":"debug","message":"Executing query [m8mo4opjnq252i8jpui]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:10:54.103Z"}
{"level":"debug","message":"Executing query [m8mo4opm7ps73rl7sii]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742796654087\"]","timestamp":"2025-03-24T06:10:54.106Z"}
{"level":"debug","message":"Executing query [m8mo4opt3u0q1vbqpwu]: INSERT INTO Dosaje (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoDosaje, Nombres, Apellidos, DocumentoIdentidad, Procedencia,\n          ResultadoCualitativo, ResultadoCuantitativo, UnidadMedida, MetodoAnalisis,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-DOSAJE-1742796654087\",\"TEST-OFICIO-1742796654087\",1779,\"ETÍLICO\",\"Persona\",\"De Prueba\",\"12345678\",\"Pruebas Automatizadas\",\"POSITIVO\",1.25,\"g/L\",\"Espectrofotometría\",\"Técnico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:10:54.113Z"}
{"level":"debug","message":"Executing query [m8mo4opzu3mzzcztwj]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.119Z"}
{"level":"debug","message":"Executing query [m8mo4oq25oi4wot1m2i]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742796654087\"]","timestamp":"2025-03-24T06:10:54.122Z"}
{"level":"debug","message":"Executing query [m8mo4oq4ooe3g7uixr]: UPDATE Dosaje SET ResultadoCualitativo = ?, Observaciones = ? WHERE IDDosaje = ?","params":"[\"NEGATIVO\",\"Registro de dosaje actualizado en pruebas\",57]","timestamp":"2025-03-24T06:10:54.124Z"}
{"level":"debug","message":"Executing query [m8mo4oq8jqny7ic0zv]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.128Z"}
{"level":"debug","message":"Executing query [m8mo4oqaj2tuaaovbf]: UPDATE Dosaje SET IsActive = FALSE WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.130Z"}
{"level":"debug","message":"Executing query [m8mo4oqdie4jr7oqbge]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.133Z"}
{"level":"debug","message":"Executing query [m8mo4oqfkufx20u1d18]: DELETE FROM Dosaje WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.135Z"}
{"level":"debug","message":"Executing query [m8mo4oqitud3kw5vl7c]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.138Z"}
{"level":"debug","message":"Executing query [m8mo4oqkrq1asd1hze]: CALL sp_insertar_dosaje(?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-SP-DOSAJE-1742796654140\",\"TEST-SP-OFICIO-1742796654140\",7170,\"ETÍLICO-SP\",\"Persona SP\",\"De Prueba SP\",\"Prueba SP\",\"Técnico SP\"]","timestamp":"2025-03-24T06:10:54.140Z"}
{"level":"debug","message":"Executing query [m8mo4oqnr3e23f7j08]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742796654140\"]","timestamp":"2025-03-24T06:10:54.143Z"}
{"level":"debug","message":"Executing query [m8mo4oqpqa6u8043cem]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742796654140\"]","timestamp":"2025-03-24T06:10:54.145Z"}
{"level":"debug","message":"Executing query [m8mo4oqsbg8zmpjb307]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:54.148Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:54.150Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:54.349Z"}
{"level":"debug","message":"Executing query [m8mo4owgp7ljdwbyzum]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:54.352Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:54.363Z"}
{"level":"debug","message":"Executing query [m8mo4owstnyrf8jm5ic]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:10:54.364Z"}
{"level":"debug","message":"Executing query [m8mo4owvyyl5fkwp79q]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742796654351\"]","timestamp":"2025-03-24T06:10:54.367Z"}
{"level":"debug","message":"Executing query [m8mo4owy1firqh7tkfd]: INSERT INTO ForenseDigital (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoPericia, Nombres, Apellidos, DelitoInvestigado,\n          DispositivoTipo, DispositivoMarca, DispositivoModelo, DispositivoNumeroSerie, MetodoExtraccion,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-FORENSE-1742796654351\",\"TEST-OFI-FORENSE-1742796654351\",8642,\"EXTRACCIÓN DE INFORMACIÓN\",\"Investigador\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"CELULAR\",\"TEST BRAND\",\"TEST MODEL\",\"SN-1742796654351\",\"MANUAL\",\"Perito de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:10:54.370Z"}
{"level":"debug","message":"Executing query [m8mo4ox4yeibd96f42q]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.376Z"}
{"level":"debug","message":"Executing query [m8mo4ox6z111acm9hjr]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742796654351\"]","timestamp":"2025-03-24T06:10:54.379Z"}
{"level":"debug","message":"Executing query [m8mo4ox86pmfm3ruvct]: UPDATE ForenseDigital SET TipoPericia = ?, Observaciones = ? WHERE IDForenseDigital = ?","params":"[\"ANALISIS DE METADATOS\",\"Registro forense actualizado en pruebas\",57]","timestamp":"2025-03-24T06:10:54.381Z"}
{"level":"debug","message":"Executing query [m8mo4oxcbzvdzd9hvpr]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.385Z"}
{"level":"debug","message":"Executing query [m8mo4oxf42k43wyekwq]: UPDATE ForenseDigital SET IsActive = FALSE WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.387Z"}
{"level":"debug","message":"Executing query [m8mo4oxic8gw9qn99e]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.390Z"}
{"level":"debug","message":"Executing query [m8mo4oxkdbu2el9zwao]: DELETE FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.392Z"}
{"level":"debug","message":"Executing query [m8mo4oxnvfdtcd5tlp]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[57]","timestamp":"2025-03-24T06:10:54.395Z"}
{"level":"debug","message":"Executing query [m8mo4oxo7e8nkdvay1r]: CALL sp_insertar_forense_digital(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-SP-FORENSE-1742796654396\",\"TEST-SP-OFI-FORENSE-1742796654396\",716,\"EXTRACCIÓN DE DATOS\",\"Investigador SP\",\"De Prueba SP\",\"PRUEBA SP\",\"LAPTOP\",\"Perito SP\"]","timestamp":"2025-03-24T06:10:54.396Z"}
{"level":"debug","message":"Executing query [m8mo4oxra85f80f5yv]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742796654396\"]","timestamp":"2025-03-24T06:10:54.399Z"}
{"level":"debug","message":"Executing query [m8mo4oxtb8b58bvyv1q]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742796654396\"]","timestamp":"2025-03-24T06:10:54.401Z"}
{"level":"debug","message":"Executing query [m8mo4oxxqk6smunnfz]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:54.405Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:54.407Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:55.116Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:55.171Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T06:10:55.174Z"}
{"level":"info","message":"Test info message","timestamp":"2025-03-24T06:10:55.281Z"}
{"level":"error","message":"Test error message","timestamp":"2025-03-24T06:10:55.282Z"}
{"level":"warn","message":"Test warning message","timestamp":"2025-03-24T06:10:55.283Z"}
{"level":"debug","message":"Test debug message","timestamp":"2025-03-24T06:10:55.284Z"}
{"action":"test","level":"info","message":"Test message with object","timestamp":"2025-03-24T06:10:55.285Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"action":"test","error":{},"level":"error","message":"Test error with object","timestamp":"2025-03-24T06:10:55.285Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:55.548Z"}
{"level":"debug","message":"Executing query [m8mo4ptq5opp3a8m40f]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:55.550Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:55.565Z"}
{"level":"debug","message":"Executing query [m8mo4pu9fm82rnwodmm]: DELETE FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742796655550\"]","timestamp":"2025-03-24T06:10:55.569Z"}
{"level":"debug","message":"Executing query [m8mo4puco1goghgmtfb]: INSERT INTO MesaPartes (Descripcion, CodigoIdentificacion, IsActive) VALUES (?, ?, ?)","params":"[\"Mesa de Partes de Prueba Automatizada\",\"TEST-MP-1742796655550\",true]","timestamp":"2025-03-24T06:10:55.572Z"}
{"level":"debug","message":"Executing query [m8mo4puh2nm6j6mj39i]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.577Z"}
{"level":"debug","message":"Executing query [m8mo4pujcrt2393otml]: SELECT * FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742796655550\"]","timestamp":"2025-03-24T06:10:55.579Z"}
{"level":"debug","message":"Executing query [m8mo4pulbonzirbwo4n]: UPDATE MesaPartes SET Descripcion = ? WHERE IDMesaPartes = ?","params":"[\"Mesa de Partes Actualizada\",57]","timestamp":"2025-03-24T06:10:55.581Z"}
{"level":"debug","message":"Executing query [m8mo4pupaimrwrxiza]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.585Z"}
{"level":"debug","message":"Executing query [m8mo4puq5zhx8m9qlu]: UPDATE MesaPartes SET IsActive = FALSE WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.586Z"}
{"level":"debug","message":"Executing query [m8mo4puua9cdpn3pmoh]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.590Z"}
{"level":"debug","message":"Executing query [m8mo4puwgl5f3913lz4]: SELECT COUNT(*) as count FROM Documento WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.592Z"}
{"level":"debug","message":"Executing query [m8mo4puym60p0gsyj9]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.594Z"}
{"level":"debug","message":"Executing query [m8mo4pv1t03x8exmmvb]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.597Z"}
{"level":"debug","message":"Executing query [m8mo4pv31ow9vzysueg]: SELECT * FROM MesaPartes WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T06:10:55.599Z"}
{"level":"debug","message":"Executing query [m8mo4pv4ipw0hy9r6u]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:55.600Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:55.601Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:55.803Z"}
{"level":"debug","message":"Executing query [m8mo4q0uh8ijbyu61l]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:55.806Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:55.816Z"}
{"level":"debug","message":"Executing query [m8mo4q16f8a8gvsh17d]: SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:10:55.818Z"}
{"level":"debug","message":"Executing query [m8mo4q17fduyaeur7sl]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = ?","params":"[888]","timestamp":"2025-03-24T06:10:55.820Z"}
{"level":"debug","message":"Executing query [m8mo4q19h6ixev0agf]: SELECT IDRol FROM Rol WHERE IDRol = ?","params":"[888]","timestamp":"2025-03-24T06:10:55.821Z"}
{"level":"debug","message":"Executing query [m8mo4q1acdav5sj39om]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TESTPAP123\",\"Usuario\",\"Papelera\",\"Teniente\",\"$2a$10$abcdefghijklmnopqrstuvwxyz12345678901234\",888,888]","timestamp":"2025-03-24T06:10:55.822Z"}
{"level":"debug","message":"Executing query [m8mo4q1fxljxzpk0wfm]: INSERT INTO MesaPartes (Descripcion, IsActive, CodigoIdentificacion) VALUES (?, ?, ?)","params":"[\"Mesa Papelera\",1,\"MP-TEST\"]","timestamp":"2025-03-24T06:10:55.827Z"}
{"level":"debug","message":"Executing query [m8mo4q1krxz2realdfh]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[58,888,58,\"DOC-TEST-001\",\"OFICIO-TEST-001\",\"2025-03-24T06:10:55.832Z\",\"ACTIVO\"]","timestamp":"2025-03-24T06:10:55.832Z"}
{"level":"info","message":"Preparación completa - Usuario ID: 58, Área ID: 888, Rol ID: 888, Documento ID: 57","timestamp":"2025-03-24T06:10:55.836Z"}
{"level":"debug","message":"Executing query [m8mo4q1p6c0rpjhe339]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[57,58,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T06:10:55.837Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mo4q1p6c0rpjhe339]","params":"[57,58,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T06:10:55.843Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T06:10:55.844Z"}
{"level":"debug","message":"Executing query [m8mo4q1wg44mb5dsfzf]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.844Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mo4q1wg44mb5dsfzf]","params":"[57]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T06:10:55.847Z"}
{"level":"error","message":"Error al mover documento a papelera: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T06:10:55.847Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T06:10:55.848Z"}
{"level":"debug","message":"Executing query [m8mo4q218bzqzjcxj2g]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[57,58,\"RESTAURAR\"]","timestamp":"2025-03-24T06:10:55.849Z"}
{"level":"debug","message":"Executing query [m8mo4q26f0aaz9c7lsn]: SELECT Estado FROM Documento WHERE IDDocumento = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.854Z"}
{"level":"debug","message":"Executing query [m8mo4q29kzaozqt1uo]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[57,58,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T06:10:55.857Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mo4q29kzaozqt1uo]","params":"[57,58,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T06:10:55.861Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T06:10:55.861Z"}
{"level":"debug","message":"Executing query [m8mo4q2dw9rot8czx7]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[57]","timestamp":"2025-03-24T06:10:55.862Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mo4q2dw9rot8czx7]","params":"[57]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T06:10:55.864Z"}
{"level":"error","message":"Error al eliminar permanentemente documento: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T06:10:55.865Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T06:10:55.865Z"}
{"level":"debug","message":"Executing query [m8mo4q2iizpedux9qyg]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[58,888,58,\"DOC-TEST-002\",\"OFICIO-TEST-002\",\"2025-03-24T06:10:55.866Z\",\"ACTIVO\"]","timestamp":"2025-03-24T06:10:55.866Z"}
{"level":"debug","message":"Executing query [m8mo4q2lqf8fez0ej9e]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[888,888,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T06:10:55.869Z"}
{"level":"debug","message":"Executing query [m8mo4q2pud2ncyxptm]: SELECT fn_verificar_permiso_contextual(?, ?, ?, ?) AS tienePermiso","params":"[58,\"DOCUMENTO\",58,\"ELIMINAR\"]","timestamp":"2025-03-24T06:10:55.873Z"}
{"level":"debug","message":"Executing query [m8mo4q2s1kqct2md9ro]: DELETE FROM Documento WHERE IDDocumento = ?","params":"[58]","timestamp":"2025-03-24T06:10:55.876Z"}
{"level":"debug","message":"Executing query [m8mo4q2vbtpakgp1dg6]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ? AND TipoRecurso = ?","params":"[888,888,\"DOCUMENTO\"]","timestamp":"2025-03-24T06:10:55.879Z"}
{"level":"debug","message":"Executing query [m8mo4q2z9474czw41jd]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[58]","timestamp":"2025-03-24T06:10:55.883Z"}
{"level":"debug","message":"Executing query [m8mo4q328cjk5eal6qk]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:10:55.886Z"}
{"level":"debug","message":"Executing query [m8mo4q33ricdr9yq6vr]: DELETE FROM PermisoContextualLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:10:55.887Z"}
{"level":"debug","message":"Executing query [m8mo4q35mmgfs72dzp]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:10:55.889Z"}
{"level":"info","message":"Usuario TESTPAP123 eliminado después de las pruebas","timestamp":"2025-03-24T06:10:55.892Z"}
{"level":"debug","message":"Executing query [m8mo4q39x9v09dcuzi8]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:55.893Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:55.894Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:56.012Z"}
{"level":"debug","message":"Executing query [m8mo4q6nbka7o9388ah]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:56.015Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:56.030Z"}
{"level":"debug","message":"Executing query [m8mo4q74qn8ebaitkf]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T06:10:56.033Z"}
{"level":"debug","message":"Executing query [m8mo4q7763qdjjdq6m]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T06:10:56.035Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de PermisoContextual","timestamp":"2025-03-24T06:10:56.037Z"}
{"level":"debug","message":"Executing query [m8mo4q7afdi1gq5wb7v]: DELETE FROM PermisoContextualLog WHERE IDPermisoContextual IN (SELECT IDPermisoContextual FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?)","params":"[999,999]","timestamp":"2025-03-24T06:10:56.038Z"}
{"level":"debug","message":"Executing query [m8mo4q7c1qmoembk1q8h]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?","params":"[999,999]","timestamp":"2025-03-24T06:10:56.040Z"}
{"level":"debug","message":"Executing query [m8mo4q7eqj8oh598pi8]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[999,999,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T06:10:56.042Z"}
{"level":"debug","message":"Executing query [m8mo4q7kni2p5ex185]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[58]","timestamp":"2025-03-24T06:10:56.048Z"}
{"level":"debug","message":"Executing query [m8mo4q7nt8im9d9co2]: SELECT * FROM v_permisos_contextuales WHERE IDPermisoContextual = ?","params":"[58]","timestamp":"2025-03-24T06:10:56.051Z"}
{"level":"debug","message":"Executing query [m8mo4q7qg8wnzw8g6o]: UPDATE PermisoContextual SET ReglaContexto = ? WHERE IDPermisoContextual = ?","params":"[\"{\\\"condicion\\\":\\\"MISMA_AREA\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",58]","timestamp":"2025-03-24T06:10:56.054Z"}
{"level":"debug","message":"Executing query [m8mo4q7ufgayq9yjpqe]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[58]","timestamp":"2025-03-24T06:10:56.058Z"}
{"level":"debug","message":"Executing query [m8mo4q7wpur0mxjj7vo]: DELETE FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[58]","timestamp":"2025-03-24T06:10:56.060Z"}
{"level":"debug","message":"Executing query [m8mo4q80gcajnrznu6f]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[58]","timestamp":"2025-03-24T06:10:56.064Z"}
{"level":"debug","message":"Executing query [m8mo4q82zkkiw7yuhad]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:56.066Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:56.068Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:56.551Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T06:10:56.663Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:56.710Z"}
{"level":"debug","message":"Executing query [m8mo4qqoj7iwhc76sy]: SELECT * FROM v_permisos_contextuales","params":"[]","timestamp":"2025-03-24T06:10:56.736Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:56.767Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:56.911Z"}
{"level":"debug","message":"Executing query [m8mo4qvm7xh5dok7e4b]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:56.914Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:56.929Z"}
{"level":"debug","message":"Executing query [m8mo4qw31aw9arfu8fo]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:10:56.931Z"}
{"level":"debug","message":"Executing query [m8mo4qw6uxpn4md97hj]: DELETE FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742796656913\"]","timestamp":"2025-03-24T06:10:56.934Z"}
{"level":"debug","message":"Executing query [m8mo4qw9zhh35oalncd]: INSERT INTO QuimicaToxicologiaForense (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          Examen, Nombres, Apellidos, DelitoInfraccion, Como,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-QUIMICA-1742796656913\",\"TEST-OFI-QUIMICA-1742796656913\",5572,\"TOXICOLOGÍA\",\"Sujeto\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"SUSTANCIA INCAUTADA\",\"Químico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:10:56.937Z"}
{"level":"debug","message":"Executing query [m8mo4qwfnnvtj9sa1li]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.943Z"}
{"level":"debug","message":"Executing query [m8mo4qwi1a81u7mrsqi]: SELECT * FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742796656913\"]","timestamp":"2025-03-24T06:10:56.946Z"}
{"level":"debug","message":"Executing query [m8mo4qwk4njtew3xbqw]: UPDATE QuimicaToxicologiaForense SET Examen = ?, Observaciones = ? WHERE IDQuimicaToxForense = ?","params":"[\"ANÁLISIS QUÍMICO\",\"Registro químico actualizado en pruebas\",29]","timestamp":"2025-03-24T06:10:56.948Z"}
{"level":"debug","message":"Executing query [m8mo4qwo20o4njsxckc]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.952Z"}
{"level":"debug","message":"Executing query [m8mo4qwqyh96cj8ldbm]: UPDATE QuimicaToxicologiaForense SET IsActive = FALSE WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.954Z"}
{"level":"debug","message":"Executing query [m8mo4qwu3fehk3hwvg2]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.958Z"}
{"level":"debug","message":"Executing query [m8mo4qwvnytsvio2oxh]: DELETE FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.959Z"}
{"level":"debug","message":"Executing query [m8mo4qwyky1d11jjnw]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[29]","timestamp":"2025-03-24T06:10:56.962Z"}
{"level":"debug","message":"Executing query [m8mo4qx02kcctczi8ic]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:56.964Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:56.965Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:57.461Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:10:57.465Z"}
{"level":"debug","message":"Executing query [m8mo4rayos8r8tnkz8b]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:10:57.466Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:10:57.477Z"}
{"level":"debug","message":"Executing query [m8mo4rbbbf98l9w5t8]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T06:10:57.479Z"}
{"level":"debug","message":"Executing query [m8mo4rbcvlg4fvqq6kf]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T06:10:57.480Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de Usuario","timestamp":"2025-03-24T06:10:57.481Z"}
{"level":"debug","message":"Executing query [m8mo4rbemu50cy95ji]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.482Z"}
{"level":"debug","message":"Executing query [m8mo4rbhevls54yzrnw]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.485Z"}
{"level":"debug","message":"Executing query [m8mo4rbjxwwpa5pkhd9]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.487Z"}
{"level":"debug","message":"Executing query [m8mo4rbk7ihwq9blf19]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TEST123456\",\"Usuario\",\"De Prueba\",\"Suboficial\",\"$2a$10$mBpQoMfPGGjYV2NzvL.YHeTw0znNqptBsYKrn.zxr5Hd2zQvmCv9q\",999,999]","timestamp":"2025-03-24T06:10:57.488Z"}
{"level":"debug","message":"Executing query [m8mo4rbosnpc2zdg05]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[59]","timestamp":"2025-03-24T06:10:57.492Z"}
{"level":"debug","message":"Executing query [m8mo4rbryuj8e8trpm]: SELECT * FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.495Z"}
{"level":"debug","message":"Executing query [m8mo4rbxc1w94c97kc6]: UPDATE Usuario SET Nombres = ? WHERE IDUsuario = ?","params":"[\"NombreActualizado\",59]","timestamp":"2025-03-24T06:10:57.501Z"}
{"level":"debug","message":"Executing query [m8mo4rc1b8a6jcdpuyl]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[59]","timestamp":"2025-03-24T06:10:57.505Z"}
{"level":"debug","message":"Executing query [m8mo4rc3ai101c1nix]: DELETE FROM Usuario WHERE IDUsuario = ?","params":"[59]","timestamp":"2025-03-24T06:10:57.507Z"}
{"level":"debug","message":"Executing query [m8mo4rc6xisw78x3rk]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[59]","timestamp":"2025-03-24T06:10:57.510Z"}
{"level":"debug","message":"Executing query [m8mo4rc7qltti6owe6r]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.511Z"}
{"level":"debug","message":"Executing query [m8mo4rc8hio13o3hnig]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:10:57.512Z"}
{"level":"info","message":"Usuario TEST123456 eliminado por CIP","timestamp":"2025-03-24T06:10:57.513Z"}
{"level":"debug","message":"Executing query [m8mo4rcawjoy4kxcsli]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:10:57.514Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:10:57.514Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:18:58.566Z"}
{"level":"debug","message":"Executing query [m8mof2jfliu2dr6e2rn]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:18:58.587Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:18:58.613Z"}
{"level":"debug","message":"Executing query [m8mof2k9z120hxhhjq]: SELECT IDArea FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742797138586\"]","timestamp":"2025-03-24T06:18:58.617Z"}
{"level":"debug","message":"Executing query [m8mof2kcglsl89xhtcg]: DELETE FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742797138586\"]","timestamp":"2025-03-24T06:18:58.620Z"}
{"level":"debug","message":"Executing query [m8mof2kewb6cbx3ncw]: INSERT INTO AreaEspecializada (NombreArea, CodigoIdentificacion, TipoArea, Descripcion, IsActive) VALUES (?, ?, ?, ?, ?)","params":"[\"Área de Prueba Automatizada\",\"TEST-AUTO-AREA-1742797138586\",\"ESPECIALIZADA\",\"Área creada para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:18:58.622Z"}
{"level":"debug","message":"Executing query [m8mof2kn4kpt40iut8g]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.631Z"}
{"level":"debug","message":"Executing query [m8mof2kqt6qwbcps10k]: SELECT * FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742797138586\"]","timestamp":"2025-03-24T06:18:58.634Z"}
{"level":"debug","message":"Executing query [m8mof2ks0vi98j9dzqus]: UPDATE AreaEspecializada SET NombreArea = ?, Descripcion = ? WHERE IDArea = ?","params":"[\"Área Actualizada\",\"Descripción actualizada para pruebas\",1029]","timestamp":"2025-03-24T06:18:58.636Z"}
{"level":"debug","message":"Executing query [m8mof2kv1rup37rx984]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.640Z"}
{"level":"debug","message":"Executing query [m8mof2ky5vpzi9rnmva]: UPDATE AreaEspecializada SET IsActive = FALSE WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.643Z"}
{"level":"debug","message":"Executing query [m8mof2l21ywfo6o7w5e]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.646Z"}
{"level":"debug","message":"Executing query [m8mof2l4oben45uza2h]: SELECT COUNT(*) as count FROM Usuario WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.648Z"}
{"level":"debug","message":"Executing query [m8mof2l668nk3f7fcpq]: DELETE FROM AreaEspecializada WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.650Z"}
{"level":"debug","message":"Executing query [m8mof2l98ja8429c9px]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[1029]","timestamp":"2025-03-24T06:18:58.653Z"}
{"level":"debug","message":"Executing query [m8mof2lb8xha5ixkva4]: SELECT * FROM AreaEspecializada WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T06:18:58.655Z"}
{"level":"debug","message":"Executing query [m8mof2ldsggc13hmv4]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:18:58.657Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:18:58.659Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:18:58.823Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:18:59.476Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T06:18:59.674Z"}
{"level":"info","message":"Iniciando pruebas de autenticación","timestamp":"2025-03-24T06:18:59.678Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:18:59.737Z"}
{"authTokenExists":true,"level":"info","message":"Estado de tokens después del login:","refreshTokenExists":true,"timestamp":"2025-03-24T06:18:59.749Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:18:59.790Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:18:59.902Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:00.020Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:00.034Z"}
{"level":"debug","message":"Executing query [m8mof3np3zpbiffuksa]: SELECT 1 as test","params":"[]","timestamp":"2025-03-24T06:19:00.037Z"}
{"level":"debug","message":"Executing query [m8mof3nqpelgnd1rea]: SELECT * FROM tabla_que_no_existe","params":"[]","timestamp":"2025-03-24T06:19:00.038Z"}
{"code":"ER_NO_SUCH_TABLE","error":"Table 'oficri_sistema.tabla_que_no_existe' doesn't exist","level":"error","message":"Database query error [m8mof3nqpelgnd1rea]","params":"[]","query":"SELECT * FROM tabla_que_no_existe","timestamp":"2025-03-24T06:19:00.041Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:00.042Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:00.139Z"}
{"level":"debug","message":"Executing query [m8mof3qmkouxbgs5jt]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:00.142Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:00.153Z"}
{"level":"debug","message":"Executing query [m8mof3qyusgrqdplfj8]: SELECT IDMesaPartes FROM MesaPartes LIMIT 1","params":"[]","timestamp":"2025-03-24T06:19:00.154Z"}
{"level":"info","message":"No se encontraron Mesas de Partes. Se requiere al menos una Mesa de Partes para las pruebas.","timestamp":"2025-03-24T06:19:00.156Z"}
{"level":"debug","message":"Executing query [m8mof3r18iwwpt25pjx]: SELECT IDArea FROM AreaEspecializada LIMIT 2","params":"[]","timestamp":"2025-03-24T06:19:00.157Z"}
{"level":"debug","message":"Executing query [m8mof3r3g1pc5tvitfv]: SELECT IDUsuario FROM Usuario LIMIT 2","params":"[]","timestamp":"2025-03-24T06:19:00.159Z"}
{"level":"info","message":"No se encontraron suficientes Usuarios. Se requieren al menos dos Usuarios para las pruebas de derivación.","timestamp":"2025-03-24T06:19:00.160Z"}
{"level":"debug","message":"Executing query [m8mof3r4kkapvwxwuae]: SELECT IDDocumento FROM Documento LIMIT 1","params":"[]","timestamp":"2025-03-24T06:19:00.160Z"}
{"level":"warn","message":"No se pueden ejecutar todas las pruebas de Derivación debido a la falta de datos necesarios.","timestamp":"2025-03-24T06:19:00.161Z"}
{"level":"debug","message":"Executing query [m8mof3r91hlxy1wr1bj]: SELECT * FROM Derivacion WHERE EstadoDerivacion = ? LIMIT 10","params":"[\"PENDIENTE\"]","timestamp":"2025-03-24T06:19:00.165Z"}
{"level":"debug","message":"Executing query [m8mof3rc3ug4h5az7ni]: SELECT * FROM Derivacion WHERE IDAreaDestino = ? LIMIT 10","params":"[888]","timestamp":"2025-03-24T06:19:00.168Z"}
{"level":"debug","message":"Executing query [m8mof3rf1mug8jfz2ac]: DELETE FROM Documento WHERE IDDocumento = ?","params":"[57]","timestamp":"2025-03-24T06:19:00.171Z"}
{"level":"debug","message":"Executing query [m8mof3ri3ijgrvv5377]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:00.174Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:01.677Z"}
{"duration":"5ms","level":"info","message":"Request completed","method":"POST","path":"/api/auth/login","status":404,"timestamp":"2025-03-24T06:19:01.735Z"}
{"level":"error","message":"Failed to obtain auth token for document API tests","timestamp":"2025-03-24T06:19:01.740Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:01.747Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T06:19:01.749Z"}
{"level":"info","message":"Usando Mesa de Partes ID: 1, Área ID: 1 y Usuario ID: 1 para las pruebas de Documento","timestamp":"2025-03-24T06:19:01.839Z"}
{"level":"info","message":"Usando Documento ID: 1 para las pruebas de DocumentoArchivo","timestamp":"2025-03-24T06:19:01.933Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:02.049Z"}
{"level":"debug","message":"Executing query [m8mof57nx8jghxrd3li]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:02.051Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:02.059Z"}
{"level":"debug","message":"Executing query [m8mof580mzbmt1b68r]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:19:02.064Z"}
{"level":"debug","message":"Executing query [m8mof584v3kg7v9ot3]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742797142051\"]","timestamp":"2025-03-24T06:19:02.068Z"}
{"level":"debug","message":"Executing query [m8mof585dknvx0y0849]: INSERT INTO Dosaje (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoDosaje, Nombres, Apellidos, DocumentoIdentidad, Procedencia,\n          ResultadoCualitativo, ResultadoCuantitativo, UnidadMedida, MetodoAnalisis,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-DOSAJE-1742797142051\",\"TEST-OFICIO-1742797142051\",1392,\"ETÍLICO\",\"Persona\",\"De Prueba\",\"12345678\",\"Pruebas Automatizadas\",\"POSITIVO\",1.25,\"g/L\",\"Espectrofotometría\",\"Técnico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:19:02.069Z"}
{"level":"debug","message":"Executing query [m8mof58a97xjzp3ooj]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.074Z"}
{"level":"debug","message":"Executing query [m8mof58eimm3s92b3x]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742797142051\"]","timestamp":"2025-03-24T06:19:02.078Z"}
{"level":"debug","message":"Executing query [m8mof58ga0r7mnfd5em]: UPDATE Dosaje SET ResultadoCualitativo = ?, Observaciones = ? WHERE IDDosaje = ?","params":"[\"NEGATIVO\",\"Registro de dosaje actualizado en pruebas\",59]","timestamp":"2025-03-24T06:19:02.080Z"}
{"level":"debug","message":"Executing query [m8mof58jpo7imtzpsd]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.083Z"}
{"level":"debug","message":"Executing query [m8mof58l4w79xa44icd]: UPDATE Dosaje SET IsActive = FALSE WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.085Z"}
{"level":"debug","message":"Executing query [m8mof58nvix4mwegize]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.087Z"}
{"level":"debug","message":"Executing query [m8mof58q483ip4vo8ss]: DELETE FROM Dosaje WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.090Z"}
{"level":"debug","message":"Executing query [m8mof58tgg11hs647g7]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.093Z"}
{"level":"debug","message":"Executing query [m8mof58umjrsmxkye9k]: CALL sp_insertar_dosaje(?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-SP-DOSAJE-1742797142094\",\"TEST-SP-OFICIO-1742797142094\",9352,\"ETÍLICO-SP\",\"Persona SP\",\"De Prueba SP\",\"Prueba SP\",\"Técnico SP\"]","timestamp":"2025-03-24T06:19:02.094Z"}
{"level":"debug","message":"Executing query [m8mof58yonuvkydgg8o]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742797142094\"]","timestamp":"2025-03-24T06:19:02.098Z"}
{"level":"debug","message":"Executing query [m8mof590stw32enjx3]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742797142094\"]","timestamp":"2025-03-24T06:19:02.100Z"}
{"level":"debug","message":"Executing query [m8mof593vusvtb8fsri]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:02.103Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:02.105Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:02.272Z"}
{"level":"debug","message":"Executing query [m8mof5dvlzczt80ss2]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:02.275Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:02.283Z"}
{"level":"debug","message":"Executing query [m8mof5e44faihxnfiug]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:19:02.284Z"}
{"level":"debug","message":"Executing query [m8mof5e6nrcqj1tgqjb]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742797142274\"]","timestamp":"2025-03-24T06:19:02.286Z"}
{"level":"debug","message":"Executing query [m8mof5e8863jehkzfxj]: INSERT INTO ForenseDigital (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoPericia, Nombres, Apellidos, DelitoInvestigado,\n          DispositivoTipo, DispositivoMarca, DispositivoModelo, DispositivoNumeroSerie, MetodoExtraccion,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-FORENSE-1742797142274\",\"TEST-OFI-FORENSE-1742797142274\",7946,\"EXTRACCIÓN DE INFORMACIÓN\",\"Investigador\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"CELULAR\",\"TEST BRAND\",\"TEST MODEL\",\"SN-1742797142274\",\"MANUAL\",\"Perito de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:19:02.288Z"}
{"level":"debug","message":"Executing query [m8mof5eex7wedokatoh]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.294Z"}
{"level":"debug","message":"Executing query [m8mof5egs4xsnxuecg]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742797142274\"]","timestamp":"2025-03-24T06:19:02.296Z"}
{"level":"debug","message":"Executing query [m8mof5eiy0fhcnb7ll9]: UPDATE ForenseDigital SET TipoPericia = ?, Observaciones = ? WHERE IDForenseDigital = ?","params":"[\"ANALISIS DE METADATOS\",\"Registro forense actualizado en pruebas\",59]","timestamp":"2025-03-24T06:19:02.298Z"}
{"level":"debug","message":"Executing query [m8mof5el66gtefe2maj]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.301Z"}
{"level":"debug","message":"Executing query [m8mof5envc79j0ww1il]: UPDATE ForenseDigital SET IsActive = FALSE WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.303Z"}
{"level":"debug","message":"Executing query [m8mof5ephyc5vmp0bil]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.305Z"}
{"level":"debug","message":"Executing query [m8mof5erqelvy97y049]: DELETE FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.307Z"}
{"level":"debug","message":"Executing query [m8mof5evdho48ls7qh]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[59]","timestamp":"2025-03-24T06:19:02.311Z"}
{"level":"debug","message":"Executing query [m8mof5ewwrny3q0r12r]: CALL sp_insertar_forense_digital(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-SP-FORENSE-1742797142312\",\"TEST-SP-OFI-FORENSE-1742797142312\",4487,\"EXTRACCIÓN DE DATOS\",\"Investigador SP\",\"De Prueba SP\",\"PRUEBA SP\",\"LAPTOP\",\"Perito SP\"]","timestamp":"2025-03-24T06:19:02.312Z"}
{"level":"debug","message":"Executing query [m8mof5f0zqymo2ag5y8]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742797142312\"]","timestamp":"2025-03-24T06:19:02.316Z"}
{"level":"debug","message":"Executing query [m8mof5f1wcczros9r2a]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742797142312\"]","timestamp":"2025-03-24T06:19:02.317Z"}
{"level":"debug","message":"Executing query [m8mof5f4uxurwqk6ws]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:02.320Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:02.321Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:02.870Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:02.914Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T06:19:02.916Z"}
{"level":"info","message":"Test info message","timestamp":"2025-03-24T06:19:03.006Z"}
{"level":"error","message":"Test error message","timestamp":"2025-03-24T06:19:03.007Z"}
{"level":"warn","message":"Test warning message","timestamp":"2025-03-24T06:19:03.008Z"}
{"level":"debug","message":"Test debug message","timestamp":"2025-03-24T06:19:03.008Z"}
{"action":"test","level":"info","message":"Test message with object","timestamp":"2025-03-24T06:19:03.009Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"action":"test","error":{},"level":"error","message":"Test error with object","timestamp":"2025-03-24T06:19:03.009Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:03.221Z"}
{"level":"debug","message":"Executing query [m8mof6481ts1tu3iek9]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:03.224Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:03.234Z"}
{"level":"debug","message":"Executing query [m8mof64kivicxwpamvn]: DELETE FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742797143223\"]","timestamp":"2025-03-24T06:19:03.236Z"}
{"level":"debug","message":"Executing query [m8mof64l1te0opkk2ae]: INSERT INTO MesaPartes (Descripcion, CodigoIdentificacion, IsActive) VALUES (?, ?, ?)","params":"[\"Mesa de Partes de Prueba Automatizada\",\"TEST-MP-1742797143223\",true]","timestamp":"2025-03-24T06:19:03.237Z"}
{"level":"debug","message":"Executing query [m8mof64sbtwebo6q86]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.244Z"}
{"level":"debug","message":"Executing query [m8mof64uh7u39bb60q]: SELECT * FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742797143223\"]","timestamp":"2025-03-24T06:19:03.246Z"}
{"level":"debug","message":"Executing query [m8mof64vh3tktz46jni]: UPDATE MesaPartes SET Descripcion = ? WHERE IDMesaPartes = ?","params":"[\"Mesa de Partes Actualizada\",59]","timestamp":"2025-03-24T06:19:03.247Z"}
{"level":"debug","message":"Executing query [m8mof64y87am338yiwc]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.250Z"}
{"level":"debug","message":"Executing query [m8mof6502hkizp39y2a]: UPDATE MesaPartes SET IsActive = FALSE WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.252Z"}
{"level":"debug","message":"Executing query [m8mof653xbvv9f67a9]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.255Z"}
{"level":"debug","message":"Executing query [m8mof655h6jsgg41dk]: SELECT COUNT(*) as count FROM Documento WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.257Z"}
{"level":"debug","message":"Executing query [m8mof657allk5z77v7]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.259Z"}
{"level":"debug","message":"Executing query [m8mof659825t55xk2wo]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.261Z"}
{"level":"debug","message":"Executing query [m8mof65a0w47fqf7g0rl]: SELECT * FROM MesaPartes WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T06:19:03.262Z"}
{"level":"debug","message":"Executing query [m8mof65cb0o3b7b878c]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:03.264Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:03.266Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:03.429Z"}
{"level":"debug","message":"Executing query [m8mof6a0pmiqa7g79z]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:03.432Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:03.441Z"}
{"level":"debug","message":"Executing query [m8mof6aboixyjz953v]: SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:19:03.443Z"}
{"level":"debug","message":"Executing query [m8mof6acjfennodynli]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = ?","params":"[888]","timestamp":"2025-03-24T06:19:03.444Z"}
{"level":"debug","message":"Executing query [m8mof6adsci5op55pk]: SELECT IDRol FROM Rol WHERE IDRol = ?","params":"[888]","timestamp":"2025-03-24T06:19:03.445Z"}
{"level":"debug","message":"Executing query [m8mof6aej29e2w2pth]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TESTPAP123\",\"Usuario\",\"Papelera\",\"Teniente\",\"$2a$10$abcdefghijklmnopqrstuvwxyz12345678901234\",888,888]","timestamp":"2025-03-24T06:19:03.446Z"}
{"level":"debug","message":"Executing query [m8mof6ajtz4a3lla4kg]: INSERT INTO MesaPartes (Descripcion, IsActive, CodigoIdentificacion) VALUES (?, ?, ?)","params":"[\"Mesa Papelera\",1,\"MP-TEST\"]","timestamp":"2025-03-24T06:19:03.451Z"}
{"level":"debug","message":"Executing query [m8mof6anomi2f8fxprk]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[60,888,60,\"DOC-TEST-001\",\"OFICIO-TEST-001\",\"2025-03-24T06:19:03.455Z\",\"ACTIVO\"]","timestamp":"2025-03-24T06:19:03.455Z"}
{"level":"info","message":"Preparación completa - Usuario ID: 60, Área ID: 888, Rol ID: 888, Documento ID: 59","timestamp":"2025-03-24T06:19:03.460Z"}
{"level":"debug","message":"Executing query [m8mof6atp6dl18zrc1]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[59,60,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T06:19:03.461Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mof6atp6dl18zrc1]","params":"[59,60,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T06:19:03.465Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T06:19:03.466Z"}
{"level":"debug","message":"Executing query [m8mof6ayf7w35m3mq79]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.466Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mof6ayf7w35m3mq79]","params":"[59]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T06:19:03.468Z"}
{"level":"error","message":"Error al mover documento a papelera: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T06:19:03.468Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T06:19:03.469Z"}
{"level":"debug","message":"Executing query [m8mof6b1j91rindpxxn]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[59,60,\"RESTAURAR\"]","timestamp":"2025-03-24T06:19:03.469Z"}
{"level":"debug","message":"Executing query [m8mof6b6bme3bf4ct06]: SELECT Estado FROM Documento WHERE IDDocumento = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.474Z"}
{"level":"debug","message":"Executing query [m8mof6b857qptsgmow]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[59,60,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T06:19:03.476Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mof6b857qptsgmow]","params":"[59,60,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T06:19:03.481Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T06:19:03.481Z"}
{"level":"debug","message":"Executing query [m8mof6be2rpd0on3jdu]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[59]","timestamp":"2025-03-24T06:19:03.482Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8mof6be2rpd0on3jdu]","params":"[59]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T06:19:03.484Z"}
{"level":"error","message":"Error al eliminar permanentemente documento: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T06:19:03.484Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T06:19:03.485Z"}
{"level":"debug","message":"Executing query [m8mof6birkgqpcazjik]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[60,888,60,\"DOC-TEST-002\",\"OFICIO-TEST-002\",\"2025-03-24T06:19:03.486Z\",\"ACTIVO\"]","timestamp":"2025-03-24T06:19:03.486Z"}
{"level":"debug","message":"Executing query [m8mof6bmg7gwlpghd5]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[888,888,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T06:19:03.490Z"}
{"level":"debug","message":"Executing query [m8mof6borsuqgs5wej]: SELECT fn_verificar_permiso_contextual(?, ?, ?, ?) AS tienePermiso","params":"[60,\"DOCUMENTO\",60,\"ELIMINAR\"]","timestamp":"2025-03-24T06:19:03.492Z"}
{"level":"debug","message":"Executing query [m8mof6br9bktik6dsm]: DELETE FROM Documento WHERE IDDocumento = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.495Z"}
{"level":"debug","message":"Executing query [m8mof6bugrk814r6vov]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ? AND TipoRecurso = ?","params":"[888,888,\"DOCUMENTO\"]","timestamp":"2025-03-24T06:19:03.498Z"}
{"level":"debug","message":"Executing query [m8mof6by9zyig8s07rq]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.502Z"}
{"level":"debug","message":"Executing query [m8mof6c00ho3guezb9of]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:19:03.504Z"}
{"level":"debug","message":"Executing query [m8mof6c1ngo8nrkk6m]: DELETE FROM PermisoContextualLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:19:03.505Z"}
{"level":"debug","message":"Executing query [m8mof6c3pxrjqfusku]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T06:19:03.507Z"}
{"level":"info","message":"Usuario TESTPAP123 eliminado después de las pruebas","timestamp":"2025-03-24T06:19:03.510Z"}
{"level":"debug","message":"Executing query [m8mof6c66sx9ukpfrft]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:03.510Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:03.511Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:03.604Z"}
{"level":"debug","message":"Executing query [m8mof6euufh5qr7r3tn]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:03.606Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:03.621Z"}
{"level":"debug","message":"Executing query [m8mof6farphgkz8u3li]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T06:19:03.622Z"}
{"level":"debug","message":"Executing query [m8mof6fcfd4v7yhnd3w]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T06:19:03.624Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de PermisoContextual","timestamp":"2025-03-24T06:19:03.626Z"}
{"level":"debug","message":"Executing query [m8mof6fetcego0a7azd]: DELETE FROM PermisoContextualLog WHERE IDPermisoContextual IN (SELECT IDPermisoContextual FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?)","params":"[999,999]","timestamp":"2025-03-24T06:19:03.626Z"}
{"level":"debug","message":"Executing query [m8mof6fgnldpdu31hf]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?","params":"[999,999]","timestamp":"2025-03-24T06:19:03.628Z"}
{"level":"debug","message":"Executing query [m8mof6fh9fh82dtkqo6]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[999,999,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T06:19:03.629Z"}
{"level":"debug","message":"Executing query [m8mof6flf9bro8hu4up]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.633Z"}
{"level":"debug","message":"Executing query [m8mof6fo5wd3mfyj5qf]: SELECT * FROM v_permisos_contextuales WHERE IDPermisoContextual = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.636Z"}
{"level":"debug","message":"Executing query [m8mof6frbm3pz011s4s]: UPDATE PermisoContextual SET ReglaContexto = ? WHERE IDPermisoContextual = ?","params":"[\"{\\\"condicion\\\":\\\"MISMA_AREA\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",60]","timestamp":"2025-03-24T06:19:03.639Z"}
{"level":"debug","message":"Executing query [m8mof6fuct8v1iferoe]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.642Z"}
{"level":"debug","message":"Executing query [m8mof6fwvyrnozjeyxn]: DELETE FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.644Z"}
{"level":"debug","message":"Executing query [m8mof6fzcsszqzuu4s]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[60]","timestamp":"2025-03-24T06:19:03.647Z"}
{"level":"debug","message":"Executing query [m8mof6g0h1l3g3ljy8i]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:03.648Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:03.649Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:04.034Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T06:19:04.110Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:04.147Z"}
{"level":"debug","message":"Executing query [m8mof6uj8f8ckvv0e4e]: SELECT * FROM v_permisos_contextuales","params":"[]","timestamp":"2025-03-24T06:19:04.171Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:04.197Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:04.301Z"}
{"level":"debug","message":"Executing query [m8mof6y8jk7qs9n5yno]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:04.304Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:04.315Z"}
{"level":"debug","message":"Executing query [m8mof6ykyau97lv0bs]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T06:19:04.316Z"}
{"level":"debug","message":"Executing query [m8mof6ynoi3x6691b3]: DELETE FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742797144303\"]","timestamp":"2025-03-24T06:19:04.319Z"}
{"level":"debug","message":"Executing query [m8mof6yo2aeubp6grw6]: INSERT INTO QuimicaToxicologiaForense (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          Examen, Nombres, Apellidos, DelitoInfraccion, Como,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[1,\"TEST-QUIMICA-1742797144303\",\"TEST-OFI-QUIMICA-1742797144303\",4539,\"TOXICOLOGÍA\",\"Sujeto\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"SUSTANCIA INCAUTADA\",\"Químico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T06:19:04.320Z"}
{"level":"debug","message":"Executing query [m8mof6yut160mywp9x]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.326Z"}
{"level":"debug","message":"Executing query [m8mof6yx4t4c92rw5bv]: SELECT * FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742797144303\"]","timestamp":"2025-03-24T06:19:04.329Z"}
{"level":"debug","message":"Executing query [m8mof6yz5kgj6cdqtht]: UPDATE QuimicaToxicologiaForense SET Examen = ?, Observaciones = ? WHERE IDQuimicaToxForense = ?","params":"[\"ANÁLISIS QUÍMICO\",\"Registro químico actualizado en pruebas\",30]","timestamp":"2025-03-24T06:19:04.331Z"}
{"level":"debug","message":"Executing query [m8mof6z3vpcj4b4f9s8]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.335Z"}
{"level":"debug","message":"Executing query [m8mof6z5w9he783u929]: UPDATE QuimicaToxicologiaForense SET IsActive = FALSE WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.337Z"}
{"level":"debug","message":"Executing query [m8mof6z8knyvljch9v]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.340Z"}
{"level":"debug","message":"Executing query [m8mof6z9lg6lb46tt98]: DELETE FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.341Z"}
{"level":"debug","message":"Executing query [m8mof6zcae16sck0a78]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[30]","timestamp":"2025-03-24T06:19:04.344Z"}
{"level":"debug","message":"Executing query [m8mof6ze279pufd61f]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:04.346Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:04.347Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:04.757Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T06:19:04.760Z"}
{"level":"debug","message":"Executing query [m8mof7ax3g4kuwf6axd]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T06:19:04.761Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T06:19:04.770Z"}
{"level":"debug","message":"Executing query [m8mof7b7wpzrd521a9]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T06:19:04.771Z"}
{"level":"debug","message":"Executing query [m8mof7b9buhn52hudkt]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T06:19:04.773Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de Usuario","timestamp":"2025-03-24T06:19:04.774Z"}
{"level":"debug","message":"Executing query [m8mof7baqv8vgcwnej7]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.774Z"}
{"level":"debug","message":"Executing query [m8mof7bbpnnp7ksahhr]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.775Z"}
{"level":"debug","message":"Executing query [m8mof7bcdeyxmzwkgas]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.776Z"}
{"level":"debug","message":"Executing query [m8mof7bdgtkrb8w71n5]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TEST123456\",\"Usuario\",\"De Prueba\",\"Suboficial\",\"$2a$10$mBpQoMfPGGjYV2NzvL.YHeTw0znNqptBsYKrn.zxr5Hd2zQvmCv9q\",999,999]","timestamp":"2025-03-24T06:19:04.777Z"}
{"level":"debug","message":"Executing query [m8mof7bij3h98thg5eo]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[61]","timestamp":"2025-03-24T06:19:04.782Z"}
{"level":"debug","message":"Executing query [m8mof7bk11z2i1yettbb]: SELECT * FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.784Z"}
{"level":"debug","message":"Executing query [m8mof7bmrfoodp58z9a]: UPDATE Usuario SET Nombres = ? WHERE IDUsuario = ?","params":"[\"NombreActualizado\",61]","timestamp":"2025-03-24T06:19:04.786Z"}
{"level":"debug","message":"Executing query [m8mof7bqrrudp8lsp7m]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[61]","timestamp":"2025-03-24T06:19:04.790Z"}
{"level":"debug","message":"Executing query [m8mof7bsgbe1al1xaka]: DELETE FROM Usuario WHERE IDUsuario = ?","params":"[61]","timestamp":"2025-03-24T06:19:04.792Z"}
{"level":"debug","message":"Executing query [m8mof7bvpanc4egn87i]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[61]","timestamp":"2025-03-24T06:19:04.795Z"}
{"level":"debug","message":"Executing query [m8mof7bw5hn12kewcp]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.796Z"}
{"level":"debug","message":"Executing query [m8mof7bxki41bn8o5n]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T06:19:04.797Z"}
{"level":"info","message":"Usuario TEST123456 eliminado por CIP","timestamp":"2025-03-24T06:19:04.798Z"}
{"level":"debug","message":"Executing query [m8mof7by924zio5nfzw]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T06:19:04.798Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T06:19:04.799Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:24.755Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:24.759Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.763Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.814Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.820Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.833Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.840Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.845Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.927Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.936Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:24.940Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:36.937Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:36.940Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:36.944Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:36.987Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:36.992Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.004Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.010Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.015Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.094Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.104Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:37.107Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:59.243Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:32:59.246Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.250Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.294Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.299Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.313Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.318Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.322Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.400Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.410Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:32:59.414Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:36:43.803Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:36:43.806Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.809Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.850Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.857Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.869Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.875Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.880Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.956Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.964Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:43.968Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:36:55.672Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:36:55.676Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.679Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.728Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.734Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.748Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.754Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.758Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.837Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.850Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:36:55.853Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:06.506Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:06.509Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.513Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.563Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.571Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.588Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.597Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.603Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.691Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.703Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:06.707Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:15.658Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:15.662Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.665Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.711Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.717Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.730Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.736Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.740Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.821Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.832Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:15.835Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:26.261Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:26.264Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.267Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.311Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.316Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.327Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.333Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.338Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.425Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.434Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:26.438Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:38.950Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:38.953Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:38.956Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.000Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.005Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.017Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.023Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.027Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.105Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.116Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:39.119Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:54.829Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:37:54.832Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.836Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.887Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.893Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.903Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.909Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.914Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:54.992Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:55.003Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:37:55.006Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:09.243Z"}
{"level":"debug","message":"Executing query [m8nneaumvce7xcnyvu]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:09.262Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:09.295Z"}
{"level":"debug","message":"Executing query [m8nneavl05cf58ju24hv]: SELECT IDArea FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742855889261\"]","timestamp":"2025-03-24T22:38:09.297Z"}
{"level":"debug","message":"Executing query [m8nneavocf4fa0n0mwm]: DELETE FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742855889261\"]","timestamp":"2025-03-24T22:38:09.301Z"}
{"level":"debug","message":"Executing query [m8nneavqvogxsvdf3y]: INSERT INTO AreaEspecializada (NombreArea, CodigoIdentificacion, TipoArea, Descripcion, IsActive) VALUES (?, ?, ?, ?, ?)","params":"[\"Área de Prueba Automatizada\",\"TEST-AUTO-AREA-1742855889261\",\"ESPECIALIZADA\",\"Área creada para pruebas automatizadas\",true]","timestamp":"2025-03-24T22:38:09.302Z"}
{"level":"debug","message":"Executing query [m8nneavwuw8xa4otun8]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.308Z"}
{"level":"debug","message":"Executing query [m8nneavye5fjxarizx5]: SELECT * FROM AreaEspecializada WHERE CodigoIdentificacion = ?","params":"[\"TEST-AUTO-AREA-1742855889261\"]","timestamp":"2025-03-24T22:38:09.310Z"}
{"level":"debug","message":"Executing query [m8nneaw0pf43ggc05p]: UPDATE AreaEspecializada SET NombreArea = ?, Descripcion = ? WHERE IDArea = ?","params":"[\"Área Actualizada\",\"Descripción actualizada para pruebas\",4]","timestamp":"2025-03-24T22:38:09.312Z"}
{"level":"debug","message":"Executing query [m8nneaw3jywciak6d9g]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.315Z"}
{"level":"debug","message":"Executing query [m8nneaw610slmqjcj3]: UPDATE AreaEspecializada SET IsActive = FALSE WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.318Z"}
{"level":"debug","message":"Executing query [m8nneaw81ydz6x0txjr]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.320Z"}
{"level":"debug","message":"Executing query [m8nneawaaq81t50rdxe]: SELECT COUNT(*) as count FROM Usuario WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.322Z"}
{"level":"debug","message":"Executing query [m8nneawce8ov8rkllsi]: DELETE FROM AreaEspecializada WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.324Z"}
{"level":"debug","message":"Executing query [m8nneawfnyshgvzgmjr]: SELECT * FROM AreaEspecializada WHERE IDArea = ?","params":"[4]","timestamp":"2025-03-24T22:38:09.327Z"}
{"level":"debug","message":"Executing query [m8nneawg3ngujdoyfga]: SELECT * FROM AreaEspecializada WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T22:38:09.328Z"}
{"level":"debug","message":"Executing query [m8nneawh0kupfagxq53]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:09.329Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:09.331Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:10.148Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:11.618Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T22:38:12.108Z"}
{"level":"info","message":"Iniciando pruebas de autenticación","timestamp":"2025-03-24T22:38:12.113Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:12.181Z"}
{"authTokenExists":true,"level":"info","message":"Estado de tokens después del login:","refreshTokenExists":true,"timestamp":"2025-03-24T22:38:12.193Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:12.236Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:12.374Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:12.491Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:12.504Z"}
{"level":"debug","message":"Executing query [m8nnedcrdnewlopvgoj]: SELECT 1 as test","params":"[]","timestamp":"2025-03-24T22:38:12.507Z"}
{"level":"debug","message":"Executing query [m8nnedcttix14g8iro]: SELECT * FROM tabla_que_no_existe","params":"[]","timestamp":"2025-03-24T22:38:12.509Z"}
{"code":"ER_NO_SUCH_TABLE","error":"Table 'oficri_sistema.tabla_que_no_existe' doesn't exist","level":"error","message":"Database query error [m8nnedcttix14g8iro]","params":"[]","query":"SELECT * FROM tabla_que_no_existe","timestamp":"2025-03-24T22:38:12.511Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:12.513Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:12.609Z"}
{"level":"debug","message":"Executing query [m8nnedfnjx71nmwitw]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:12.611Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:12.623Z"}
{"level":"debug","message":"Executing query [m8nnedg1gsd4t88nz7r]: SELECT IDMesaPartes FROM MesaPartes LIMIT 1","params":"[]","timestamp":"2025-03-24T22:38:12.625Z"}
{"level":"info","message":"No se encontraron Mesas de Partes. Se requiere al menos una Mesa de Partes para las pruebas.","timestamp":"2025-03-24T22:38:12.628Z"}
{"level":"debug","message":"Executing query [m8nnedg473fkqa37gu]: SELECT IDArea FROM AreaEspecializada LIMIT 2","params":"[]","timestamp":"2025-03-24T22:38:12.628Z"}
{"level":"info","message":"No se encontraron suficientes Áreas. Se requieren al menos dos Áreas para las pruebas de derivación.","timestamp":"2025-03-24T22:38:12.629Z"}
{"level":"debug","message":"Executing query [m8nnedg66z7ihmzdezf]: SELECT IDUsuario FROM Usuario LIMIT 2","params":"[]","timestamp":"2025-03-24T22:38:12.630Z"}
{"level":"info","message":"No se encontraron suficientes Usuarios. Se requieren al menos dos Usuarios para las pruebas de derivación.","timestamp":"2025-03-24T22:38:12.631Z"}
{"level":"debug","message":"Executing query [m8nnedg7y8o2tc8t03]: SELECT IDDocumento FROM Documento LIMIT 1","params":"[]","timestamp":"2025-03-24T22:38:12.631Z"}
{"level":"warn","message":"No se pueden ejecutar todas las pruebas de Derivación debido a la falta de datos necesarios.","timestamp":"2025-03-24T22:38:12.632Z"}
{"level":"debug","message":"Executing query [m8nnedgcgeo14ys7bxo]: SELECT * FROM Derivacion WHERE EstadoDerivacion = ? LIMIT 10","params":"[\"PENDIENTE\"]","timestamp":"2025-03-24T22:38:12.636Z"}
{"level":"debug","message":"Executing query [m8nnedgf0ld6c1b4jf9c]: SELECT * FROM Derivacion WHERE IDAreaDestino = ? LIMIT 10","params":"[null]","timestamp":"2025-03-24T22:38:12.639Z"}
{"level":"debug","message":"Executing query [m8nnedgh8fqvur3o5mw]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:12.641Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:19.243Z"}
{"duration":"7ms","level":"info","message":"Request completed","method":"POST","path":"/api/auth/login","status":404,"timestamp":"2025-03-24T22:38:19.305Z"}
{"level":"error","message":"Failed to obtain auth token for document API tests","timestamp":"2025-03-24T22:38:19.311Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:19.318Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T22:38:19.319Z"}
{"level":"info","message":"Usando Mesa de Partes ID: 1, Área ID: 1 y Usuario ID: 1 para las pruebas de Documento","timestamp":"2025-03-24T22:38:19.411Z"}
{"level":"info","message":"Usando Documento ID: 1 para las pruebas de DocumentoArchivo","timestamp":"2025-03-24T22:38:19.506Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:19.623Z"}
{"level":"debug","message":"Executing query [m8nneiui2cg3htanlui]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:19.626Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:19.634Z"}
{"level":"debug","message":"Executing query [m8nneiusr78kil9mpkg]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T22:38:19.636Z"}
{"level":"debug","message":"Executing query [m8nneiuupuaz4s2dxik]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742855899625\"]","timestamp":"2025-03-24T22:38:19.638Z"}
{"level":"debug","message":"Executing query [m8nneiuwssrl7sjkv4i]: INSERT INTO Dosaje (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoDosaje, Nombres, Apellidos, DocumentoIdentidad, Procedencia,\n          ResultadoCualitativo, ResultadoCuantitativo, UnidadMedida, MetodoAnalisis,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[3,\"TEST-DOSAJE-1742855899625\",\"TEST-OFICIO-1742855899625\",4971,\"ETÍLICO\",\"Persona\",\"De Prueba\",\"12345678\",\"Pruebas Automatizadas\",\"POSITIVO\",1.25,\"g/L\",\"Espectrofotometría\",\"Técnico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T22:38:19.640Z"}
{"level":"debug","message":"Executing query [m8nneiv27tlvhrx4qka]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.646Z"}
{"level":"debug","message":"Executing query [m8nneiv400z20pmgncln]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-DOSAJE-1742855899625\"]","timestamp":"2025-03-24T22:38:19.648Z"}
{"level":"debug","message":"Executing query [m8nneivasfvk87b2uq]: UPDATE Dosaje SET ResultadoCualitativo = ?, Observaciones = ? WHERE IDDosaje = ?","params":"[\"NEGATIVO\",\"Registro de dosaje actualizado en pruebas\",1]","timestamp":"2025-03-24T22:38:19.654Z"}
{"level":"debug","message":"Executing query [m8nneivdlx5n735xnpe]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.657Z"}
{"level":"debug","message":"Executing query [m8nneivfwwhbbzzrrv]: UPDATE Dosaje SET IsActive = FALSE WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.659Z"}
{"level":"debug","message":"Executing query [m8nneividfne004e1o]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.662Z"}
{"level":"debug","message":"Executing query [m8nneivkg6apwyfcezb]: DELETE FROM Dosaje WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.664Z"}
{"level":"debug","message":"Executing query [m8nneivn4wlr5prxp2r]: SELECT * FROM Dosaje WHERE IDDosaje = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.667Z"}
{"level":"debug","message":"Executing query [m8nneivp9ulzydtnzi4]: CALL sp_insertar_dosaje(?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[3,\"TEST-SP-DOSAJE-1742855899669\",\"TEST-SP-OFICIO-1742855899669\",4072,\"ETÍLICO-SP\",\"Persona SP\",\"De Prueba SP\",\"Prueba SP\",\"Técnico SP\"]","timestamp":"2025-03-24T22:38:19.669Z"}
{"level":"debug","message":"Executing query [m8nneivtpvwvirlcxjr]: SELECT * FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742855899669\"]","timestamp":"2025-03-24T22:38:19.673Z"}
{"level":"debug","message":"Executing query [m8nneivujif48ktacki]: DELETE FROM Dosaje WHERE NumeroRegistro = ?","params":"[\"TEST-SP-DOSAJE-1742855899669\"]","timestamp":"2025-03-24T22:38:19.674Z"}
{"level":"debug","message":"Executing query [m8nneivx3il6gzjd6n9]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:19.677Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:19.678Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:19.843Z"}
{"level":"debug","message":"Executing query [m8nnej0lzn49lqggzcq]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:19.845Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:19.855Z"}
{"level":"debug","message":"Executing query [m8nnej0wn049ivfrfj]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T22:38:19.856Z"}
{"level":"debug","message":"Executing query [m8nnej0xbg7pcurgww4]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742855899844\"]","timestamp":"2025-03-24T22:38:19.857Z"}
{"level":"debug","message":"Executing query [m8nnej116n18ryu4dl]: INSERT INTO ForenseDigital (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          TipoPericia, Nombres, Apellidos, DelitoInvestigado,\n          DispositivoTipo, DispositivoMarca, DispositivoModelo, DispositivoNumeroSerie, MetodoExtraccion,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[3,\"TEST-FORENSE-1742855899844\",\"TEST-OFI-FORENSE-1742855899844\",4289,\"EXTRACCIÓN DE INFORMACIÓN\",\"Investigador\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"CELULAR\",\"TEST BRAND\",\"TEST MODEL\",\"SN-1742855899844\",\"MANUAL\",\"Perito de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T22:38:19.861Z"}
{"level":"debug","message":"Executing query [m8nnej153sj7gbtc3ix]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.865Z"}
{"level":"debug","message":"Executing query [m8nnej18lm2knwhy]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-FORENSE-1742855899844\"]","timestamp":"2025-03-24T22:38:19.868Z"}
{"level":"debug","message":"Executing query [m8nnej19pjegcw521s]: UPDATE ForenseDigital SET TipoPericia = ?, Observaciones = ? WHERE IDForenseDigital = ?","params":"[\"ANALISIS DE METADATOS\",\"Registro forense actualizado en pruebas\",1]","timestamp":"2025-03-24T22:38:19.869Z"}
{"level":"debug","message":"Executing query [m8nnej1ce3ofqtnc0f]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.872Z"}
{"level":"debug","message":"Executing query [m8nnej1evj5mbuazt4m]: UPDATE ForenseDigital SET IsActive = FALSE WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.874Z"}
{"level":"debug","message":"Executing query [m8nnej1h5gwvre5qiv9]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.877Z"}
{"level":"debug","message":"Executing query [m8nnej1jvka0k674md8]: DELETE FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.879Z"}
{"level":"debug","message":"Executing query [m8nnej1m1vrkex5a0li]: SELECT * FROM ForenseDigital WHERE IDForenseDigital = ?","params":"[1]","timestamp":"2025-03-24T22:38:19.882Z"}
{"level":"debug","message":"Executing query [m8nnej1nm60ajhnuq4i]: CALL sp_insertar_forense_digital(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[3,\"TEST-SP-FORENSE-1742855899883\",\"TEST-SP-OFI-FORENSE-1742855899883\",7858,\"EXTRACCIÓN DE DATOS\",\"Investigador SP\",\"De Prueba SP\",\"PRUEBA SP\",\"LAPTOP\",\"Perito SP\"]","timestamp":"2025-03-24T22:38:19.883Z"}
{"level":"debug","message":"Executing query [m8nnej1sy9qnbnlw7]: SELECT * FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742855899883\"]","timestamp":"2025-03-24T22:38:19.888Z"}
{"level":"debug","message":"Executing query [m8nnej1t4ngy23r4qi]: DELETE FROM ForenseDigital WHERE NumeroRegistro = ?","params":"[\"TEST-SP-FORENSE-1742855899883\"]","timestamp":"2025-03-24T22:38:19.889Z"}
{"level":"debug","message":"Executing query [m8nnej1wfph9iwqszb]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:19.892Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:19.893Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:20.438Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:20.482Z"}
{"level":"error","message":"Error al conectar a la base de datos: Pool is closed.","stack":"Error: Pool is closed.\n    at D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\pool.js:55:21\n    at PoolConnection.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:818:13)\n    at Object.onceWrapper (node:events:628:26)\n    at PoolConnection.emit (node:events:513:28)\n    at ClientHandshake.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:137:14)\n    at ClientHandshake.emit (node:events:513:28)\n    at ClientHandshake.execute (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\commands\\command.js:49:10)\n    at PoolConnection.handlePacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:475:34)\n    at PacketParser.onPacket (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:93:12)\n    at PacketParser.executeStart (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\packet_parser.js:75:16)\n    at Socket.<anonymous> (D:\\proye\\OFICRI\\pagina\\Final\\refactored\\OFICRI\\node_modules\\mysql2\\lib\\base\\connection.js:100:25)\n    at Socket.emit (node:events:513:28)\n    at addChunk (node:internal/streams/readable:559:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\n    at Socket.Readable.push (node:internal/streams/readable:390:5)\n    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)","timestamp":"2025-03-24T22:38:20.485Z"}
{"level":"info","message":"Test info message","timestamp":"2025-03-24T22:38:20.573Z"}
{"level":"error","message":"Test error message","timestamp":"2025-03-24T22:38:20.574Z"}
{"level":"warn","message":"Test warning message","timestamp":"2025-03-24T22:38:20.574Z"}
{"level":"debug","message":"Test debug message","timestamp":"2025-03-24T22:38:20.575Z"}
{"action":"test","level":"info","message":"Test message with object","timestamp":"2025-03-24T22:38:20.576Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"action":"test","error":{},"level":"error","message":"Test error with object","timestamp":"2025-03-24T22:38:20.576Z","user":{"id":1,"name":"Test User","roles":["admin","user"]}}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:20.786Z"}
{"level":"debug","message":"Executing query [m8nnejqs9p9xvj4jefs]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:20.788Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:20.799Z"}
{"level":"debug","message":"Executing query [m8nnejr5dr27grejsov]: DELETE FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742855900787\"]","timestamp":"2025-03-24T22:38:20.801Z"}
{"level":"debug","message":"Executing query [m8nnejr7l3k50cg3rer]: INSERT INTO MesaPartes (Descripcion, CodigoIdentificacion, IsActive) VALUES (?, ?, ?)","params":"[\"Mesa de Partes de Prueba Automatizada\",\"TEST-MP-1742855900787\",true]","timestamp":"2025-03-24T22:38:20.803Z"}
{"level":"debug","message":"Executing query [m8nnejrb5p9jm6qyx26]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.807Z"}
{"level":"debug","message":"Executing query [m8nnejrevnwwx438od]: SELECT * FROM MesaPartes WHERE CodigoIdentificacion = ?","params":"[\"TEST-MP-1742855900787\"]","timestamp":"2025-03-24T22:38:20.810Z"}
{"level":"debug","message":"Executing query [m8nnejrg6qk5jbaului]: UPDATE MesaPartes SET Descripcion = ? WHERE IDMesaPartes = ?","params":"[\"Mesa de Partes Actualizada\",1]","timestamp":"2025-03-24T22:38:20.812Z"}
{"level":"debug","message":"Executing query [m8nnejrkoyo642bas9p]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.816Z"}
{"level":"debug","message":"Executing query [m8nnejrnah9s19dlv74]: UPDATE MesaPartes SET IsActive = FALSE WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.819Z"}
{"level":"debug","message":"Executing query [m8nnejrqo4lhprr49vs]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.822Z"}
{"level":"debug","message":"Executing query [m8nnejrswjnen0nxuv]: SELECT COUNT(*) as count FROM Documento WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.824Z"}
{"level":"debug","message":"Executing query [m8nnejruu5lokr2jdr]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.826Z"}
{"level":"debug","message":"Executing query [m8nnejrwnbhbeqpv61m]: SELECT * FROM MesaPartes WHERE IDMesaPartes = ?","params":"[1]","timestamp":"2025-03-24T22:38:20.828Z"}
{"level":"debug","message":"Executing query [m8nnejrz2jp94a968xf]: SELECT * FROM MesaPartes WHERE IsActive = TRUE","params":"[]","timestamp":"2025-03-24T22:38:20.831Z"}
{"level":"debug","message":"Executing query [m8nnejs16ldyiktrbh9]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:20.833Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:20.834Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:20.998Z"}
{"level":"debug","message":"Executing query [m8nnejwpae44bmthk2l]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:21.001Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:21.009Z"}
{"level":"debug","message":"Executing query [m8nnejwyzf1lghdtoha]: SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T22:38:21.010Z"}
{"level":"debug","message":"Executing query [m8nnejx07ccoikmpvv]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = ?","params":"[888]","timestamp":"2025-03-24T22:38:21.012Z"}
{"level":"debug","message":"Executing query [m8nnejx1fqx5eqi70l]: INSERT INTO AreaEspecializada (IDArea, NombreArea, CodigoIdentificacion, TipoArea, IsActive) VALUES (?, ?, ?, ?, ?)","params":"[888,\"Área Papelera\",\"TEST-PAPELERA\",\"PRUEBA\",1]","timestamp":"2025-03-24T22:38:21.013Z"}
{"level":"debug","message":"Executing query [m8nnejx5uxwqxtjxvt]: SELECT IDRol FROM Rol WHERE IDRol = ?","params":"[888]","timestamp":"2025-03-24T22:38:21.017Z"}
{"level":"debug","message":"Executing query [m8nnejx7lr4ey0ihai]: INSERT INTO Rol (IDRol, NombreRol, Descripcion, NivelAcceso, Permisos) VALUES (?, ?, ?, ?, ?)","params":"[888,\"Rol Papelera\",\"Rol para pruebas de papelera\",2,4]","timestamp":"2025-03-24T22:38:21.019Z"}
{"level":"debug","message":"Executing query [m8nnejx9zgbxzv4833d]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TESTPAP123\",\"Usuario\",\"Papelera\",\"Teniente\",\"$2a$10$abcdefghijklmnopqrstuvwxyz12345678901234\",888,888]","timestamp":"2025-03-24T22:38:21.021Z"}
{"level":"debug","message":"Executing query [m8nnejxcgsxc1ul2whi]: INSERT INTO MesaPartes (Descripcion, IsActive, CodigoIdentificacion) VALUES (?, ?, ?)","params":"[\"Mesa Papelera\",1,\"MP-TEST\"]","timestamp":"2025-03-24T22:38:21.024Z"}
{"level":"debug","message":"Executing query [m8nnejxgdud8nrxhdr]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[2,888,2,\"DOC-TEST-001\",\"OFICIO-TEST-001\",\"2025-03-24T22:38:21.028Z\",\"ACTIVO\"]","timestamp":"2025-03-24T22:38:21.028Z"}
{"level":"info","message":"Preparación completa - Usuario ID: 2, Área ID: 888, Rol ID: 888, Documento ID: 1","timestamp":"2025-03-24T22:38:21.032Z"}
{"level":"debug","message":"Executing query [m8nnejxlghl6c8mvk9q]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[1,2,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T22:38:21.033Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8nnejxlghl6c8mvk9q]","params":"[1,2,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T22:38:21.038Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T22:38:21.039Z"}
{"level":"debug","message":"Executing query [m8nnejxrtbqkcw5y5e8]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.039Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8nnejxrtbqkcw5y5e8]","params":"[1]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T22:38:21.042Z"}
{"level":"error","message":"Error al mover documento a papelera: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T22:38:21.042Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T22:38:21.042Z"}
{"level":"debug","message":"Executing query [m8nnejxvuof3v0gltj9]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[1,2,\"RESTAURAR\"]","timestamp":"2025-03-24T22:38:21.043Z"}
{"level":"debug","message":"Executing query [m8nnejy06uz4219912w]: SELECT Estado FROM Documento WHERE IDDocumento = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.048Z"}
{"level":"debug","message":"Executing query [m8nnejy20yac3peos3to]: CALL sp_papelera_reciclaje(?, ?, ?)","params":"[1,2,\"MOVER_PAPELERA\"]","timestamp":"2025-03-24T22:38:21.050Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8nnejy20yac3peos3to]","params":"[1,2,\"MOVER_PAPELERA\"]","query":"CALL sp_papelera_reciclaje(?, ?, ?)","timestamp":"2025-03-24T22:38:21.053Z"}
{"level":"warn","message":"Error al llamar al procedimiento sp_papelera_reciclaje: Column 'IDUsuario' cannot be null. Realizando actualización manual...","timestamp":"2025-03-24T22:38:21.054Z"}
{"level":"debug","message":"Executing query [m8nnejy62eo6ir829x8]: UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.054Z"}
{"code":"ER_BAD_NULL_ERROR","error":"Column 'IDUsuario' cannot be null","level":"error","message":"Database query error [m8nnejy62eo6ir829x8]","params":"[1]","query":"UPDATE Documento SET \n            Estado = 'PAPELERA', \n            Observaciones = CONCAT(IFNULL(Observaciones, ''), ' | Movido a papelera por test en ', NOW()) \n          WHERE IDDocumento = ?","timestamp":"2025-03-24T22:38:21.056Z"}
{"level":"error","message":"Error al eliminar permanentemente documento: Column 'IDUsuario' cannot be null","timestamp":"2025-03-24T22:38:21.057Z"}
{"level":"info","message":"Continuando con la prueba a pesar del error...","timestamp":"2025-03-24T22:38:21.057Z"}
{"level":"debug","message":"Executing query [m8nnejyad5mlrudlyef]: INSERT INTO Documento (IDMesaPartes, IDAreaActual, IDUsuarioCreador, NroRegistro, NumeroOficioDocumento, FechaDocumento, Estado) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[2,888,2,\"DOC-TEST-002\",\"OFICIO-TEST-002\",\"2025-03-24T22:38:21.058Z\",\"ACTIVO\"]","timestamp":"2025-03-24T22:38:21.058Z"}
{"level":"debug","message":"Executing query [m8nnejydc8c2gymhh5]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[888,888,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T22:38:21.061Z"}
{"level":"debug","message":"Executing query [m8nnejyg2jt1tectpsj]: SELECT fn_verificar_permiso_contextual(?, ?, ?, ?) AS tienePermiso","params":"[2,\"DOCUMENTO\",2,\"ELIMINAR\"]","timestamp":"2025-03-24T22:38:21.064Z"}
{"level":"debug","message":"Executing query [m8nnejyjmikv84x53tp]: DELETE FROM Documento WHERE IDDocumento = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.067Z"}
{"level":"debug","message":"Executing query [m8nnejynysknkrhznd]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ? AND TipoRecurso = ?","params":"[888,888,\"DOCUMENTO\"]","timestamp":"2025-03-24T22:38:21.071Z"}
{"level":"debug","message":"Executing query [m8nnejyqe59juj66w2q]: DELETE FROM MesaPartes WHERE IDMesaPartes = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.074Z"}
{"level":"debug","message":"Executing query [m8nnejyu16qazcw6sr]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T22:38:21.078Z"}
{"level":"debug","message":"Executing query [m8nnejywosuvorniz5]: DELETE FROM PermisoContextualLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T22:38:21.080Z"}
{"level":"debug","message":"Executing query [m8nnejyy71b2kovkdbx]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TESTPAP123\"]","timestamp":"2025-03-24T22:38:21.082Z"}
{"level":"info","message":"Usuario TESTPAP123 eliminado después de las pruebas","timestamp":"2025-03-24T22:38:21.085Z"}
{"level":"debug","message":"Executing query [m8nnejz132xrh9jcwni]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:21.085Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:21.086Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:21.178Z"}
{"level":"debug","message":"Executing query [m8nnek1o8fdhqlh858]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:21.181Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:21.191Z"}
{"level":"debug","message":"Executing query [m8nnek21bb24f692mun]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T22:38:21.193Z"}
{"level":"debug","message":"Executing query [m8nnek242mppqooqs6m]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T22:38:21.196Z"}
{"level":"debug","message":"Executing query [m8nnek26vp0is4g25s9]: INSERT INTO AreaEspecializada (IDArea, NombreArea, CodigoIdentificacion, TipoArea, IsActive, Descripcion) VALUES (?, ?, ?, ?, ?, ?)","params":"[999,\"Área de Prueba\",\"TEST-AREA\",\"PRUEBA\",1,\"Área creada para pruebas\"]","timestamp":"2025-03-24T22:38:21.198Z"}
{"level":"debug","message":"Executing query [m8nnek2buq5wjkjdlae]: INSERT INTO Rol (IDRol, NombreRol, Descripcion, NivelAcceso, Permisos) VALUES (?, ?, ?, ?, ?)","params":"[999,\"Rol de Prueba\",\"Rol creado para pruebas\",1,255]","timestamp":"2025-03-24T22:38:21.203Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de PermisoContextual","timestamp":"2025-03-24T22:38:21.207Z"}
{"level":"debug","message":"Executing query [m8nnek2g6ph8sj7c9ke]: DELETE FROM PermisoContextualLog WHERE IDPermisoContextual IN (SELECT IDPermisoContextual FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?)","params":"[999,999]","timestamp":"2025-03-24T22:38:21.208Z"}
{"level":"debug","message":"Executing query [m8nnek2ij6bld09raee]: DELETE FROM PermisoContextual WHERE IDRol = ? AND IDArea = ?","params":"[999,999]","timestamp":"2025-03-24T22:38:21.210Z"}
{"level":"debug","message":"Executing query [m8nnek2limv0ufl4uuo]: INSERT INTO PermisoContextual (IDRol, IDArea, TipoRecurso, ReglaContexto, Activo) VALUES (?, ?, ?, ?, ?)","params":"[999,999,\"DOCUMENTO\",\"{\\\"condicion\\\":\\\"PROPIETARIO\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",true]","timestamp":"2025-03-24T22:38:21.213Z"}
{"level":"debug","message":"Executing query [m8nnek2qvgdospn2m09]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.218Z"}
{"level":"debug","message":"Executing query [m8nnek2ubsx7bsxapm8]: SELECT * FROM v_permisos_contextuales WHERE IDPermisoContextual = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.222Z"}
{"level":"debug","message":"Executing query [m8nnek2zb2vwey1s1u]: UPDATE PermisoContextual SET ReglaContexto = ? WHERE IDPermisoContextual = ?","params":"[\"{\\\"condicion\\\":\\\"MISMA_AREA\\\",\\\"accion\\\":\\\"ELIMINAR\\\"}\",2]","timestamp":"2025-03-24T22:38:21.227Z"}
{"level":"debug","message":"Executing query [m8nnek33cvj3t7cboa]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.231Z"}
{"level":"debug","message":"Executing query [m8nnek37wtgaykfj50j]: DELETE FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.235Z"}
{"level":"debug","message":"Executing query [m8nnek3au7myibt7uhn]: SELECT * FROM PermisoContextual WHERE IDPermisoContextual = ?","params":"[2]","timestamp":"2025-03-24T22:38:21.238Z"}
{"level":"debug","message":"Executing query [m8nnek3eucizcy2doxe]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:21.242Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:21.244Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:21.610Z"}
{"level":"info","message":"📚 Documentación Swagger disponible en /api-docs","timestamp":"2025-03-24T22:38:21.662Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:21.702Z"}
{"level":"debug","message":"Executing query [m8nnekgqudi1ug31lc]: SELECT * FROM v_permisos_contextuales","params":"[]","timestamp":"2025-03-24T22:38:21.722Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:21.752Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:21.854Z"}
{"level":"debug","message":"Executing query [m8nnekkg0crxtaxjf9t6]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:21.856Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:21.866Z"}
{"level":"debug","message":"Executing query [m8nnekkrmb42xt8npeq]: SELECT IDArea FROM AreaEspecializada LIMIT 1","params":"[]","timestamp":"2025-03-24T22:38:21.867Z"}
{"level":"debug","message":"Executing query [m8nnekkt052tqv19q4z6]: DELETE FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742855901855\"]","timestamp":"2025-03-24T22:38:21.869Z"}
{"level":"debug","message":"Executing query [m8nnekkv7su31cgvmes]: INSERT INTO QuimicaToxicologiaForense (\n          IDArea, NumeroRegistro, FechaIngreso, OficioDoc, NumeroOficio,\n          Examen, Nombres, Apellidos, DelitoInfraccion, Como,\n          Responsable, Observaciones, IsActive\n        ) VALUES (?, ?, CURDATE(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":"[3,\"TEST-QUIMICA-1742855901855\",\"TEST-OFI-QUIMICA-1742855901855\",6057,\"TOXICOLOGÍA\",\"Sujeto\",\"De Prueba\",\"PRUEBA AUTOMATIZADA\",\"SUSTANCIA INCAUTADA\",\"Químico de prueba\",\"Registro creado para pruebas automatizadas\",true]","timestamp":"2025-03-24T22:38:21.871Z"}
{"level":"debug","message":"Executing query [m8nnekl1gwccw6f1t4]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.877Z"}
{"level":"debug","message":"Executing query [m8nnekl5d5u61c4blm]: SELECT * FROM QuimicaToxicologiaForense WHERE NumeroRegistro = ?","params":"[\"TEST-QUIMICA-1742855901855\"]","timestamp":"2025-03-24T22:38:21.881Z"}
{"level":"debug","message":"Executing query [m8nnekl6vaenap3nsm9]: UPDATE QuimicaToxicologiaForense SET Examen = ?, Observaciones = ? WHERE IDQuimicaToxForense = ?","params":"[\"ANÁLISIS QUÍMICO\",\"Registro químico actualizado en pruebas\",1]","timestamp":"2025-03-24T22:38:21.882Z"}
{"level":"debug","message":"Executing query [m8nnekl95fixj9f3bhb]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.885Z"}
{"level":"debug","message":"Executing query [m8nneklbslwooovfpn]: UPDATE QuimicaToxicologiaForense SET IsActive = FALSE WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.887Z"}
{"level":"debug","message":"Executing query [m8nneklegt0vwhe3cdt]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.890Z"}
{"level":"debug","message":"Executing query [m8nneklgrp9i80zwss]: DELETE FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.892Z"}
{"level":"debug","message":"Executing query [m8nneklklsx668x3kgo]: SELECT * FROM QuimicaToxicologiaForense WHERE IDQuimicaToxForense = ?","params":"[1]","timestamp":"2025-03-24T22:38:21.896Z"}
{"level":"debug","message":"Executing query [m8nnekllx59gd78jz4]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:21.897Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:21.898Z"}
{"level":"debug","message":"Configuración de base de datos: host=localhost, port=3306, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:22.306Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=Oficri_sistema","timestamp":"2025-03-24T22:38:22.308Z"}
{"level":"debug","message":"Executing query [m8nnekx20unoudrt579l]: SET FOREIGN_KEY_CHECKS = 0","params":"[]","timestamp":"2025-03-24T22:38:22.310Z"}
{"level":"info","message":"Conexión a la base de datos establecida","timestamp":"2025-03-24T22:38:22.320Z"}
{"level":"debug","message":"Executing query [m8nnekxd1555sx3pmnf]: SELECT IDArea FROM AreaEspecializada WHERE IDArea = 999","params":"[]","timestamp":"2025-03-24T22:38:22.321Z"}
{"level":"debug","message":"Executing query [m8nnekxemhxgt75hewr]: SELECT IDRol FROM Rol WHERE IDRol = 999","params":"[]","timestamp":"2025-03-24T22:38:22.322Z"}
{"level":"info","message":"Usando Área ID: 999 y Rol ID: 999 para las pruebas de Usuario","timestamp":"2025-03-24T22:38:22.324Z"}
{"level":"debug","message":"Executing query [m8nnekxgb0fq1wi8mfv]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.324Z"}
{"level":"debug","message":"Executing query [m8nnekxhq8ticq345sm]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.325Z"}
{"level":"debug","message":"Executing query [m8nnekxile2j49wlamd]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.326Z"}
{"level":"debug","message":"Executing query [m8nnekxjo7kci3vrs5]: INSERT INTO Usuario (CodigoCIP, Nombres, Apellidos, Grado, PasswordHash, IDArea, IDRol) VALUES (?, ?, ?, ?, ?, ?, ?)","params":"[\"TEST123456\",\"Usuario\",\"De Prueba\",\"Suboficial\",\"$2a$10$mBpQoMfPGGjYV2NzvL.YHeTw0znNqptBsYKrn.zxr5Hd2zQvmCv9q\",999,999]","timestamp":"2025-03-24T22:38:22.327Z"}
{"level":"debug","message":"Executing query [m8nnekxn8wackyln734]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[3]","timestamp":"2025-03-24T22:38:22.331Z"}
{"level":"debug","message":"Executing query [m8nnekxp4ft7ie66hjs]: SELECT * FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.333Z"}
{"level":"debug","message":"Executing query [m8nnekxrsn5yv9aw7lp]: UPDATE Usuario SET Nombres = ? WHERE IDUsuario = ?","params":"[\"NombreActualizado\",3]","timestamp":"2025-03-24T22:38:22.335Z"}
{"level":"debug","message":"Executing query [m8nnekxt9xhj2a451t4]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[3]","timestamp":"2025-03-24T22:38:22.337Z"}
{"level":"debug","message":"Executing query [m8nnekxvpmqxgbort8s]: DELETE FROM Usuario WHERE IDUsuario = ?","params":"[3]","timestamp":"2025-03-24T22:38:22.339Z"}
{"level":"debug","message":"Executing query [m8nnekxy7vkt9reeahs]: SELECT * FROM Usuario WHERE IDUsuario = ?","params":"[3]","timestamp":"2025-03-24T22:38:22.342Z"}
{"level":"debug","message":"Executing query [m8nneky1tssyme3558]: DELETE FROM UsuarioLog WHERE IDUsuario IN (SELECT IDUsuario FROM Usuario WHERE CodigoCIP = ?)","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.345Z"}
{"level":"debug","message":"Executing query [m8nneky405wtmhp60j9h]: DELETE FROM Usuario WHERE CodigoCIP = ?","params":"[\"TEST123456\"]","timestamp":"2025-03-24T22:38:22.348Z"}
{"level":"info","message":"Usuario TEST123456 eliminado por CIP","timestamp":"2025-03-24T22:38:22.349Z"}
{"level":"debug","message":"Executing query [m8nneky5igwjz1b4luk]: SET FOREIGN_KEY_CHECKS = 1","params":"[]","timestamp":"2025-03-24T22:38:22.349Z"}
{"level":"info","message":"Database connection pool closed successfully","timestamp":"2025-03-24T22:38:22.351Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:38:46.839Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:38:46.842Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.845Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.887Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.893Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.929Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.935Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.940Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.945Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:46.954Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:47.032Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:47.040Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:38:47.043Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:39:19.843Z"}
{"level":"debug","message":"Configuración DB: host=localhost, user=root, database=oficri_sistema","timestamp":"2025-03-24T22:39:19.846Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.849Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.887Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.894Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.929Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.935Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.942Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.947Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:19.953Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:20.030Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:20.037Z"}
{"level":"debug","message":"Conexión a: localhost@oficri_sistema como root","timestamp":"2025-03-24T22:39:20.042Z"}
